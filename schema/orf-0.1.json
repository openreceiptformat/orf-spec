{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://openreceipt.org/schema/orf-0.1.json",
  "title": "Open Receipt Format (ORF)",
  "type": "object",
  "required": [
    "orf_version",
    "receipt",
    "merchant",
    "line_items",
    "total",
    "currency"
  ],
  "properties": {
    "orf_version": {
      "type": "string",
      "example": "0.1.0"
    },

    "receipt": {
      "type": "object",
      "required": ["receipt_id", "issue_timestamp", "receipt_type"],
      "properties": {
        "receipt_id": { "type": "string" },
        "issue_timestamp": {
          "type": "string",
          "format": "date-time"
        },
        "receipt_type": {
          "type": "string",
          "enum": ["sale", "refund", "void", "proforma"]
        },
        "status": {
          "type": "string",
          "enum": ["issued", "voided", "reissued"]
        }
      }
    },

    "merchant": {
      "type": "object",
      "required": ["legal_name", "country_code"],
      "properties": {
        "merchant_id": { "type": "string" },
        "legal_name": { "type": "string" },
        "display_name": { "type": "string" },
        "country_code": {
          "type": "string",
          "pattern": "^[A-Z]{2}$"
        },
        "tax_identifiers": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "scheme": { "type": "string" },
              "value": { "type": "string" }
            }
          }
        }
      }
    },

    "customer": {
      "type": "object",
      "properties": {
        "customer_id": { "type": "string" },
        "legal_name": { "type": "string" },
        "tax_identifiers": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "scheme": { "type": "string" },
              "value": { "type": "string" }
            }
          }
        }
      }
    },

    "line_items": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["description", "quantity", "unit_price", "line_total"],
        "properties": {
          "line_item_id": { "type": "string" },
          "description": { "type": "string" },
          "quantity": { "type": "number" },
          "unit_price": { "type": "number" },
          "net_amount": { "type": "number" },
          "line_total": { "type": "number" }
        }
      }
    },

    "tax": {
      "type": "object",
      "properties": {
        "tax_scheme": { "type": "string" },
        "tax_lines": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["rate", "tax_amount"],
            "properties": {
              "rate": { "type": "number" },
              "base_amount": { "type": "number" },
              "tax_amount": { "type": "number" },
              "jurisdiction": { "type": "string" }
            }
          }
        }
      }
    },

    "payment": {
      "type": "object",
      "properties": {
        "payment_method": { "type": "string" },
        "provider": { "type": "string" },
        "authorization_code": { "type": "string" }
      }
    },

    "total": {
      "type": "number"
    },

    "currency": {
      "type": "string",
      "pattern": "^[A-Z]{3}$"
    },

    "trust": {
      "type": "object",
      "properties": {
        "hash": { "type": "string" },
        "hash_algorithm": { "type": "string" },
        "signature": { "type": "string" },
        "signed_by": { "type": "string" }
      }
    },

    "extensions": {
      "type": "object",
      "additionalProperties": true
    }
  }
}
